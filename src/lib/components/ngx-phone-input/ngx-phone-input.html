<div class="phone-input-container">
  <!-- Country Selector -->
  <div class="country-selector" (click)="toggleDropdown()">
    <span class="flag">{{ selectedCountry().flag }}</span>
    <span class="dial-code">{{ selectedCountry().dialCode }}</span>
    <span class="arrow" [class.open]="isDropdownOpen()">â–¼</span>
  </div>

  <!-- Phone Number Input -->
  <input
    type="tel"
    class="phone-input"
    [placeholder]="placeholder()"
    [(ngModel)]="phoneNumber"
    (input)="onPhoneNumberChange($event)"
    [disabled]="disabled()"
  />

  <!-- Country Dropdown -->
  <div class="dropdown" [class.show]="isDropdownOpen()" (click)="$event.stopPropagation()">
    <div class="search-container">
      <input
        type="text"
        class="search-input"
        placeholder="Search countries..."
        [(ngModel)]="searchTerm"
        (input)="filterCountries()"
        #searchInput
      />
    </div>
    <div class="countries-list" >
      @for (country of filteredCountries(); track country.dialCode) {
        <div
          class="country-item"
          [class.selected]="country.iso2 === selectedCountry().iso2"
          (click)="selectCountry(country)"
        >
          <span class="flag">{{ country.flag }}</span>
          <span class="name">{{ country.name }}</span>
          <span class="dial-code">{{ country.dialCode }}</span>
        </div>
      }
    </div>
  </div>

  <!-- Backdrop to close dropdown -->
  @if (isDropdownOpen()) {
    <div class="backdrop" (click)="closeDropdown()"></div>
  }
</div>
